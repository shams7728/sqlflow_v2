{
    "id": "group-by",
    "title": "GROUP BY Clause",
    "category": "Grouping",
    "difficulty": "Intermediate",
    "estimatedTime": "12 min",
    "starterQuery": "SELECT department, COUNT(*) FROM employees GROUP BY department;",
    "theory": [
        {
            "type": "paragraph",
            "text": "1. What is GROUP BY in SQL?\nThe GROUP BY clause is used to arrange identical data into groups. It is often used with aggregate functions like COUNT(), SUM(), AVG(), etc., to perform operations on each group of data."
        },
        {
            "type": "paragraph",
            "text": "2. Why is GROUP BY important?\nIt allows summarizing large datasets. For example, you can count employees in each department or calculate average salary per team."
        },
        {
            "type": "paragraph",
            "text": "3. Where is GROUP BY used?\nCommon in reports and dashboards to group sales by region, students by grade, or users by status. It's also helpful when combining data aggregation and filtering."
        },
        {
            "type": "paragraph",
            "text": "4. How to use GROUP BY?\nUse it with aggregate functions. For example:\nSELECT department, COUNT(*) FROM employees GROUP BY department;"
        },
        {
            "type": "table",
            "columns": [
                "Clause/Function",
                "Description"
            ],
            "rows": [
                [
                    "GROUP BY",
                    "Groups records by specified column(s)"
                ],
                [
                    "COUNT()",
                    "Counts records in each group"
                ],
                [
                    "SUM()",
                    "Adds up values in each group"
                ],
                [
                    "AVG()",
                    "Calculates average for each group"
                ]
            ]
        },
        {
            "type": "note",
            "text": "Every column in SELECT that is not an aggregate function must be listed in the GROUP BY clause."
        },
        {
            "type": "code",
            "text": "SELECT department, AVG(salary) FROM employees GROUP BY department;"
        }
    ],
    "schema": {
        "tables": [
            {
                "name": "employees",
                "columns": [
                    {
                        "name": "id",
                        "type": "INTEGER",
                        "constraints": "PRIMARY KEY"
                    },
                    {
                        "name": "name",
                        "type": "TEXT",
                        "constraints": "NOT NULL"
                    },
                    {
                        "name": "department",
                        "type": "TEXT"
                    },
                    {
                        "name": "salary",
                        "type": "REAL"
                    }
                ]
            }
        ]
    },
    "sample_data": {
        "employees": [
            {
                "id": 1,
                "name": "Alice",
                "department": "HR",
                "salary": 55000
            },
            {
                "id": 2,
                "name": "Bob",
                "department": "Engineering",
                "salary": 70000
            },
            {
                "id": 3,
                "name": "Charlie",
                "department": "Engineering",
                "salary": 72000
            },
            {
                "id": 4,
                "name": "Diana",
                "department": "HR",
                "salary": 58000
            },
            {
                "id": 5,
                "name": "Eve",
                "department": "Marketing",
                "salary": 60000
            }
        ]
    },
    "examples": [
        {
            "query": "SELECT department, COUNT(*) FROM employees GROUP BY department;",
            "description": "Count employees in each department",
            "explanation": "This groups employees by department and counts how many employees are in each one."
        },
        {
            "query": "SELECT department, AVG(salary) FROM employees GROUP BY department;",
            "description": "Average salary per department",
            "explanation": "Calculates the average salary for each department."
        }
    ],
    "practice": [
        {
            "id": "practice_1",
            "title": "Basic GROUP BY Clause Query",
            "description": "Practice the fundamental concepts of GROUP BY Clause.",
            "starterCode": "-- Practice GROUP BY Clause\n-- Write your query here",
            "solution": "-- Solution will depend on the specific GROUP BY Clause lesson",
            "hint": "Review the GROUP BY Clause syntax and examples from the theory section.",
            "expectedOutput": "Results demonstrating GROUP BY Clause functionality."
        },
        {
            "id": "practice_2",
            "title": "Intermediate GROUP BY Clause",
            "description": "Apply GROUP BY Clause with additional complexity.",
            "starterCode": "-- Intermediate GROUP BY Clause practice\n-- Your code here",
            "solution": "-- More complex GROUP BY Clause solution",
            "hint": "Combine GROUP BY Clause with other SQL concepts you've learned.",
            "expectedOutput": "More complex results using GROUP BY Clause."
        },
        {
            "id": "practice_3",
            "title": "Advanced GROUP BY Clause",
            "description": "Master advanced GROUP BY Clause techniques.",
            "starterCode": "-- Advanced GROUP BY Clause practice\n-- Your advanced query here",
            "solution": "-- Advanced GROUP BY Clause solution",
            "hint": "Think about edge cases and optimization for GROUP BY Clause.",
            "expectedOutput": "Advanced GROUP BY Clause results with optimized performance."
        },
        {
            "id": "practice_4",
            "title": "Real-world GROUP BY Clause",
            "description": "Apply GROUP BY Clause to solve a realistic business problem.",
            "starterCode": "-- Real-world GROUP BY Clause scenario\n-- Solve the business problem",
            "solution": "-- Business-focused GROUP BY Clause solution",
            "hint": "Consider how GROUP BY Clause would be used in actual database applications.",
            "expectedOutput": "Practical results that solve real business needs."
        }
    ],
    "quiz": [
        {
            "id": "group-by_q1",
            "type": "mcq",
            "question": "What is the primary purpose of GROUP BY Clause?",
            "options": [
                "To modify table structure",
                "To query data from tables",
                "To implement GROUP BY Clause functionality",
                "To create database backups"
            ],
            "answer": "To implement GROUP BY Clause functionality",
            "explanation": "GROUP BY Clause is specifically designed to handle its particular SQL functionality as described in the lesson."
        },
        {
            "id": "group-by_q2",
            "type": "truefalse",
            "question": "GROUP BY Clause can be used with other SQL clauses and commands.",
            "answer": true,
            "explanation": "Most SQL commands including GROUP BY Clause can be combined with other clauses to create more powerful and specific queries."
        },
        {
            "id": "group-by_q3",
            "type": "mcq",
            "question": "Which of the following is a key consideration when using GROUP BY Clause?",
            "options": [
                "Performance impact",
                "Data accuracy",
                "Syntax correctness",
                "All of the above"
            ],
            "answer": "All of the above",
            "explanation": "When using GROUP BY Clause, you should always consider performance, data accuracy, and correct syntax to ensure optimal results."
        },
        {
            "id": "group-by_q4",
            "type": "truefalse",
            "question": "GROUP BY Clause is supported by all SQL database systems.",
            "answer": false,
            "explanation": "Different SQL database systems may have variations in syntax and support for various SQL features. Always check your specific database documentation."
        },
        {
            "id": "group-by_q5",
            "type": "mcq",
            "question": "What happens if you use incorrect syntax with GROUP BY Clause?",
            "options": [
                "The query runs with default values",
                "The database crashes",
                "You get a syntax error",
                "The query is automatically corrected"
            ],
            "answer": "You get a syntax error",
            "explanation": "SQL databases will return syntax errors when commands are not properly formatted, helping you identify and fix issues."
        },
        {
            "id": "group-by_q6",
            "type": "mcq",
            "question": "When learning GROUP BY Clause, what is the best practice?",
            "options": [
                "Memorize all syntax variations",
                "Practice with real examples",
                "Only read the documentation",
                "Skip the fundamentals"
            ],
            "answer": "Practice with real examples",
            "explanation": "Hands-on practice with real examples is the most effective way to master SQL concepts and build practical skills."
        },
        {
            "id": "group-by_q7",
            "type": "truefalse",
            "question": "Understanding GROUP BY Clause is important for database professionals.",
            "answer": true,
            "explanation": "GROUP BY Clause is a fundamental SQL concept that database professionals should understand to work effectively with databases."
        },
        {
            "id": "group-by_q8",
            "type": "mcq",
            "question": "What should you do before using GROUP BY Clause in a production environment?",
            "options": [
                "Test it thoroughly",
                "Read the documentation",
                "Understand the impact",
                "All of the above"
            ],
            "answer": "All of the above",
            "explanation": "Before using any SQL command in production, you should test thoroughly, read documentation, and understand the potential impact on your system."
        }
    ],
    "challenges": [
        {
            "id": "group-by_ch1",
            "title": "Departmental Summary",
            "steps": [
                {
                    "stepId": "group-by_ch1_step1",
                    "description": "Step 1: Count how many employees each department has.",
                    "solution": "SELECT department, COUNT(*) FROM employees GROUP BY department;"
                },
                {
                    "stepId": "group-by_ch1_step2",
                    "description": "Step 2: Get the average salary of each department.",
                    "solution": "SELECT department, AVG(salary) FROM employees GROUP BY department;"
                }
            ]
        }
    ]
}